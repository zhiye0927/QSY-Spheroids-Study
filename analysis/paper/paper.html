<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-06-03">
<meta name="keywords" content="<p>keyword 1; keyword 2; keyword 3</p>">

<title>Shaping strategies and standardisation of faceted spheroids from Qianshangying (North China)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="paper_files/libs/quarto-html/quarto.js"></script>
<script src="paper_files/libs/quarto-html/popper.min.js"></script>
<script src="paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Shaping strategies and standardisation of faceted spheroids from Qianshangying (North China)</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Text of abstract</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p></p><p>keyword 1; keyword 2; keyword 3</p><p></p>
  </div>
</div>

</header>


<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->
<!-- With the following code you can access and display values from the yml header above. -->
<p>Keywords: keyword 1; keyword 2; keyword 3</p>
<p>Highlights: These are the highlights.</p>
<!-- The actual document text starts here: -->
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>…Qianshangying (QSY) ….</p>
<p>Here is a citation <span class="citation" data-cites="Marwick2017">(<a href="#ref-Marwick2017" role="doc-biblioref">Marwick 2017</a>)</span></p>
</section>
<section id="background" class="level1">
<h1>Background</h1>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>In this study, the 3d models of the cores were collected and used for morphometric and technological analysis. Digital data were captured using Artec Spider, and post-processing was carried out with Artec Studio [version number]. The 3D scan files and all the R and Python code used in the analyses reported here are openly available online at https://doi.org/xxxx/xxxx/.</p>
<section id="core-type-and-typology" class="level2">
<h2 class="anchored" data-anchor-id="core-type-and-typology">Core Type and Typology</h2>
</section>
<section id="morphometric-analysis" class="level2">
<h2 class="anchored" data-anchor-id="morphometric-analysis">Morphometric Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 读取 Excel 文件</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"analysis/data/derived_data/flaking_intensity_and_shape.xlsx"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>n_of_artefacts <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on typological study, we identify 13 rounded faceted sub-spheroids/spheroids in QSY site. Inevitably, the classification of stone artifacts under the guidance of typology relies on subjective judgment, and the identification of stone core types may vary with researchers. [BM: feels like this belongs in results section]</p>
<p><del>To avoid preconceptions and self-justification,</del> We <del>try to</del> applied quantitative methods to <del>help confirm the spheroids in site. These morphological measurements designed to</del> indicate <del>whether these identified spheroids are spherical and</del> the degree of difference between the archaeological spheroids and a perfect sphere. This included computing the sphericity index, 3D spherical harmonics, spherical harmonic energy and the centroid offset for each artefact. We <del>will</del> also examined the degree of standardization of the spheroids by comparing coefficients of variation [citation] of sphericity [and what else].</p>
<p>In addition to the archaeological spheroids, we included other multidirectional-multifacial cores in the morphological study to explore whether they can be distinguished from the spheroids. Furthermore, we compared the results of the typological and our new morphometric analyses to investigate the validity of the traditional typological approach.</p>
<section id="sphericity-index" class="level3">
<h3 class="anchored" data-anchor-id="sphericity-index">Sphericity index</h3>
<p>To evaluate the degree to which the artifacts approximate a perfect sphere, this study employs a standardized sphericity index originally proposed by <span class="citation" data-cites="Wadell1935">Wadell (<a href="#ref-Wadell1935" role="doc-biblioref">1935</a>)</span> and later adapted for 3D digital models in geoscientific research. The index is calculated using the following formula:</p>
<p><span class="math display">\[
\Psi = \frac{\pi^{1/3} (6V)^{2/3}}{A}
\]</span></p>
<p>Where V is the volume and A is the surface area of the object. This dimensionless metric yields a maximum value of 1 for a perfect sphere. Values closer to 1 indicate a higher degree of sphericity, thus serving as a reliable proxy for assessing the morphological regularity and intentional shaping of the spheroids. We used Python to derive surface area and volume measurements from 3D mesh models. The models were were decimated to a consistent face count and subjected to unit normalization, ensuring comparability across specimens. [BM: check if we need this here]</p>
</section>
<section id="d-spherical-harmonics-analysis" class="level3">
<h3 class="anchored" data-anchor-id="d-spherical-harmonics-analysis">3D spherical harmonics analysis</h3>
<p>Spherical Harmonic (SPHARM) analysis is a method for describing 3D shapes using a series of mathematical functions defined on the surface of a sphere. It works like a 3D version of Fourier analysis, breaking down complex shapes into components of different spatial frequencies. Each shape is first mapped onto a unit sphere and then expressed as a combination of spherical harmonic functions <span class="math inline">\(Y_l^m(\theta, \phi)\)</span>. The shape is represented by a set of coefficients <span class="math inline">\(\hat{f}(l, m)\)</span>, which capture how much each function contributes. Here, θ and ϕ are angles in spherical coordinates, l and m are order and degree respectively. Lower-order terms describe the general shape, while higher-order terms capture finer details<span class="citation" data-cites="Link2024 Medyukhina2020 Harper2022">(<a href="#ref-Link2024" role="doc-biblioref">Link et al. 2024</a>; <a href="#ref-Medyukhina2020" role="doc-biblioref">Medyukhina et al. 2020</a>; <a href="#ref-Harper2022" role="doc-biblioref">Harper, Goldstein, and Sylvester 2022</a>)</span>. This method is widely used in the field of biology, such as <del>for</del> the analysis of skull morphology and cell morphology [citations]. However, there are currently very few application of SPHARM to archaeological artifacts <span class="citation" data-cites="Muller2023 Noshita2025">(<a href="#ref-Muller2023" role="doc-biblioref">Muller et al. 2023</a>; <a href="#ref-Noshita2025" role="doc-biblioref">Noshita et al. 2025</a>)</span>. Our work aims to demonstrate the usefulness of SPHARM for shape analysis of objects that are roughly spherical in shape, such as the spheroids and cores studied in this research.</p>
<p>We first imported, cleaned, and simplified the STL files of spheroids and cores to extract 3D mesh vertices, which were then converted from Cartesian (x, y, z) to spherical coordinates (r, θ, φ) [citation]. Next, we interpolated radial values onto a regular spherical grid and then decomposed them using spherical harmonics based on the Driscoll–Healy sampling scheme [citation]. The resulting coefficients were normalized for scale-invariant comparison across models.</p>
<p>From the normalized spherical harmonic coefficients, we computed the rotation-invariant power spectrum by summing the squared magnitudes of the coefficients at each degree. Each 3D shape is thus represented by its unique power spectrum, which serves as a multidimensional descriptor. To explore variation between models, we applied UMAP for dimensionality reduction and visualization <span class="citation" data-cites="Van2023">(<a href="#ref-Van2023" role="doc-biblioref">Bavel, Thiels, and Jelier 2023</a>)</span>.</p>
<p>This study represents the first attempt in archaeology to apply SPHARM for the classification of cores. Specifically, we include a set of standard geometric models—such as sphere, rounded cube, ellipsoid (1.2:1:0.8) rounded rectangular prism (1.2:1:1), and disc-like (flattened, and like discoid core)—in the SPHARM analysis and UMAP. Cores are positioned in this position based on their morphological similarity to these reference models: individuals that cluster more closely to a specific standard form exhibit corresponding shape characteristics. [BM: this text probably better in the intro or background section]</p>
</section>
<section id="spherical-harmonic-energy" class="level3">
<h3 class="anchored" data-anchor-id="spherical-harmonic-energy">Spherical Harmonic energy</h3>
<p>Additionally, we compute the spherical harmonic energy (SHE), defined as the sum of squared spherical harmonic coefficients for each degree. This provides a rotation-invariant measure of shape complexity across spatial frequencies. For normalized shapes, this total energy approaches 1 for an ideal sphere, while more irregular forms yield higher values.</p>
<p>Notably, classic sphericity metrics <span class="citation" data-cites="Wadell1935">(<a href="#ref-Wadell1935" role="doc-biblioref">Wadell 1935</a>)</span> exhibit critical limitations in differentiating morphotypes with equivalent surface-area-to-volume ratios. For instance, rough spheres and smooth ellipsoids may achieve comparable Wadell values despite fundamentally distinct geometries. SHE overcomes this constraint through spherical harmonic decomposition of surface morphology, and this allows it to distinguish localized irregularities (like core edge or concave) from global shape deviations (e.g., elongation) – differences that classic sphericity metrics often fail to capture.</p>
<p>We computed the total energy at degree 20, a resolution high enough to capture surface details. Lower energy values indicate smoother and more regular surfaces, while higher values reflect more irregular or angular geometries. Unlike sphericity, which may overestimate sphericality in irregular objects, spherical harmonic energy better captures fine-scale shape deviations.</p>
</section>
<section id="centroid-offset" class="level3">
<h3 class="anchored" data-anchor-id="centroid-offset">Centroid offset</h3>
<p>To evaluate how closely an artifact approximates a sphere, this study uses the distance between its centre of mass (CoM) and the centre of its bounding box (CoBB) as a measure of volumetric symmetry <span class="citation" data-cites="Muller2023">(<a href="#ref-Muller2023" role="doc-biblioref">Muller et al. 2023</a>)</span>. A perfect sphere will have its CoM and CoBB perfectly aligned, resulting in a zero offset. As the object becomes more irregular or asymmetric, this offset increases. For each 3d model, the CoBB is defined as the midpoint of the maximum orthogonal dimensions—length (y), width (x), and thickness (z)—of its minimum bounding box. The CoM, which approximates the true mass center for objects made of homogeneous materials, is computed by weighting each triangular face of the mesh by its surface area and normalizing the result. The distance between CoM and CoBB, normalized by the artifact’s volume, serves as a quantitative indicator of sphericity: lower values indicate more spherical forms.</p>
</section>
</section>
<section id="technological-analysis" class="level2">
<h2 class="anchored" data-anchor-id="technological-analysis">Technological Analysis</h2>
<p>To investigate the production strategies of spheroids in QSY, this part aims to determine whether these artifacts were intentionally shaped and whether their manufacture followed standardized procedures. Addressing this question is crucial for evaluating whether spheroids represent a distinct technological category, separate from exhausted cores.</p>
<section id="diacritical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="diacritical-analysis">Diacritical analysis</h3>
<p>We applied diacritical analysis to reconstruct the reduction sequence based on superimposition relationships among scars on spheroids <span class="citation" data-cites="tittonSubspheroidsLithicAssemblage2020 Cabanes2024">(<a href="#ref-tittonSubspheroidsLithicAssemblage2020" role="doc-biblioref">Titton et al. 2020</a>; <a href="#ref-Cabanes2024" role="doc-biblioref">Cabanès et al. 2024</a>)</span>. This method enables the identification of scars order, allowing us to figure out the organization of removals. All spheroids, polyhedron and multifacial cores are included in the analysis to assess whether removals organization differs systematically within these groups.</p>
<p>Following the reconstruction of reduction sequences, we adopted an inductive approach to infer exploitation models of spheroids—that is, the removal patterns and associated stages employed in a spheroid. Ideally, the goal is to reconstruct the complete chaîne opératoire of spheroids—from the selection of raw material and initial blank to the final product. If consistent patterns are observed, they may indicate shared reduction schemes or conceptual templates. Furthermore, we explore whether multifacial cores and polyhedrons may represent earlier stages in spheroid reduction sequences, contributing to understanding the technological relationship between these types.</p>
</section>
<section id="orientation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="orientation-analysis">Orientation analysis</h3>
<p>To further investigate technological strategies, we incorporated orientation statistics as a complementary approach. This method derives from fabric analysis originally used in sedimentology and has since been adapted to study the arrangement of flake scars on lithic artifacts. We followed the protocol developed by Sam Lin <span class="citation" data-cites="Lin2024">(<a href="#ref-Lin2024" role="doc-biblioref">Lin 2024</a>)</span>, extracting scar vectors from each core and calculating eigenvalues to derive the isotropic ratio and elongation ratio, these steps are finished in Geomagic Wrap, Rhino8 and R.</p>
<p>Results are visualized using ternary plots to compare orientation statistics between spheroids and other core types. Based on our hypothesis, if spheroids were shaped following a consistent reduction sequence, they should exhibit similar and patterned orientation results. In contrast, if they merely represent exhausted cores, the orientation patterns would appear random and highly variable, similar to those of undirected polyhedron and multifacial cores.</p>
</section>
</section>
<section id="efficiency-of-shaping-strategy" class="level2">
<h2 class="anchored" data-anchor-id="efficiency-of-shaping-strategy">Efficiency of shaping strategy</h2>
<p>This section aims to investigate how the morphology of spheroids evolves during the reduction process. We hypothesize that, as reduction intensity increases, spheroids will progressively approximate a perfect sphere. This would indicate a high-efficiency shaping strategy, where each step is directed toward achieving a predefined morphological goal. To test this hypothesis, we established a set of quantitative indicators for reduction intensity and spheroid morphology.</p>
<section id="degree-of-reduction" class="level3">
<h3 class="anchored" data-anchor-id="degree-of-reduction">Degree of reduction</h3>
<p>To compute the degree of reduction we collected data on three metrics: scar number, removal ratio and scar density index (SDI). We measured scar number as total number of flake scars visible on the spheroid surface. Removal ratio was calculated as 1 minus cortex ratio, where the cortex ratio represents the proportion of cortical surface area to total surface area. [BM: add a sentence to define cortex ratio and give citation.] We used the removal ratio instead of the traditional cortex ratio in order to maintain a positive correlation with other reduction intensity indicators. SDI is defined as the number of flake scars divided by the total 3D surface area, the SDI serves as a robust indicator of core reduction intensity, following <span class="citation" data-cites="clarksonMeasuringCoreReduction2013">Clarkson (<a href="#ref-clarksonMeasuringCoreReduction2013" role="doc-biblioref">2013</a>)</span>. It has been demonstrated to effectively capture the dynamic nature of the reduction process.In all three metrics, higher values represent more advanced stages of reduction. Scar counts and surface area measurements were extracted using Geomagic Wrap.</p>
</section>
<section id="spheroid-shape" class="level3">
<h3 class="anchored" data-anchor-id="spheroid-shape">Spheroid shape</h3>
<p>We measured spheroid shape with four metrics: sphericity, and spherical harmonic energy, along with mean edge angle, mean surface curvature. Higher average edge angles suggest a more spherical geometry. Ten edge intersections were randomly sampled per spheroid. Angles were calculated following <span class="citation" data-cites="tittonSubspheroidsLithicAssemblage2020">Titton et al. (<a href="#ref-tittonSubspheroidsLithicAssemblage2020" role="doc-biblioref">2020</a>)</span> by constructing triangles at ridge intersections, extracting vertex coordinates in Geomagic Wrap, and computed angles from the coordinates using trigonometric functions in R. Mean surface curvature is a proxy for surface roughness, and higher mean surface curvature indicates a smoother surface. We estimated local curvature using the k-nearest neighbors method to fit a best-fit plane at each vertex <span class="citation" data-cites="Muller2023">(<a href="#ref-Muller2023" role="doc-biblioref">Muller et al. 2023</a>)</span>. The deviation between actual surface points and this fitted plane reflects surface roughness. The calculation steps were completed in Python.</p>
<p>Together, these four variables allowed us to assess whether more extensively reduced spheroids display more standardized, symmetrical, and regular morphologies—characteristics expected in deliberate shaping strategies. We conducted Spearman’s rank correlation analysis between two sets of variables—reduction intensity indicators and morphological attributes. This non-parametric method is appropriate for small sample sizes and data that do not follow a normal distribution. A total of 13 final-stage spheroids and sub-spheroids from the site were included in the analysis.</p>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multifacial and polyhedron cores</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"analysis/data/derived_data/core technological parameters.xlsx"</span>)) </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>multifacial_and_polyhedron_cores <span class="ot">&lt;-</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    cores <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Typology <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Spheroid"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Subspheroid"</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Subsperoid"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>n_multifacial_and_polyhedron_cores <span class="ot">&lt;-</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>(multifacial_and_polyhedron_cores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="results-of-morphometric-analysis" class="level2">
<h2 class="anchored" data-anchor-id="results-of-morphometric-analysis">Results of Morphometric analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multifacial_and_polyhedron_cores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-cores" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cores-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Our table
</figcaption>
<div aria-describedby="tbl-cores-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Blank type</th>
<th style="text-align: left;">Blank morphology</th>
<th style="text-align: left;">Final morphology</th>
<th style="text-align: left;">Typology</th>
<th style="text-align: left;">typology by SPHARM</th>
<th style="text-align: right;">Sphericity</th>
<th style="text-align: right;">SPHARM power</th>
<th style="text-align: right;">Centroid offset</th>
<th style="text-align: left;">Cortex covered</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">QSY_A_0256</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Ellipsoid</td>
<td style="text-align: right;">0.8658388</td>
<td style="text-align: right;">1.020296</td>
<td style="text-align: right;">1.571368</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_0562</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Discoid-like</td>
<td style="text-align: right;">0.8269944</td>
<td style="text-align: right;">1.042784</td>
<td style="text-align: right;">1.490442</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_0570</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Discoid-like</td>
<td style="text-align: right;">0.8255318</td>
<td style="text-align: right;">1.079571</td>
<td style="text-align: right;">1.282095</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_0576</td>
<td style="text-align: left;">Flake</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Discoid-like</td>
<td style="text-align: right;">0.8091313</td>
<td style="text-align: right;">1.049576</td>
<td style="text-align: right;">2.104250</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_0579</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.7988300</td>
<td style="text-align: right;">1.054399</td>
<td style="text-align: right;">1.161040</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_0680</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8032364</td>
<td style="text-align: right;">1.039023</td>
<td style="text-align: right;">1.285673</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_0682</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Rounded cube</td>
<td style="text-align: right;">0.9166715</td>
<td style="text-align: right;">1.010390</td>
<td style="text-align: right;">6.530839</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_0699</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8807450</td>
<td style="text-align: right;">1.024810</td>
<td style="text-align: right;">2.363453</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_0700</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Rounded cube</td>
<td style="text-align: right;">0.8933988</td>
<td style="text-align: right;">1.017122</td>
<td style="text-align: right;">1.039335</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_0702</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Ellipsoid</td>
<td style="text-align: right;">0.8419195</td>
<td style="text-align: right;">1.042415</td>
<td style="text-align: right;">6.912960</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_0735</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Rounded cube</td>
<td style="text-align: right;">0.8678116</td>
<td style="text-align: right;">1.019932</td>
<td style="text-align: right;">2.539858</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_0938</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8690457</td>
<td style="text-align: right;">1.027144</td>
<td style="text-align: right;">4.001371</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_1111</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Ellipsoid</td>
<td style="text-align: right;">0.8717981</td>
<td style="text-align: right;">1.022741</td>
<td style="text-align: right;">1.109560</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_1304</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Rounded cube</td>
<td style="text-align: right;">0.9274082</td>
<td style="text-align: right;">1.012530</td>
<td style="text-align: right;">3.038120</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_1307</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Discoid-like</td>
<td style="text-align: right;">0.8675301</td>
<td style="text-align: right;">1.036793</td>
<td style="text-align: right;">3.550725</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_1333</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8606773</td>
<td style="text-align: right;">1.031251</td>
<td style="text-align: right;">2.519639</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_1517</td>
<td style="text-align: left;">Flake</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Discoid-like</td>
<td style="text-align: right;">0.7955195</td>
<td style="text-align: right;">1.075345</td>
<td style="text-align: right;">3.171066</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_1584</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Rounded cube</td>
<td style="text-align: right;">0.8547083</td>
<td style="text-align: right;">1.018949</td>
<td style="text-align: right;">7.942392</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_2049</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8688198</td>
<td style="text-align: right;">1.031176</td>
<td style="text-align: right;">1.426403</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_2381</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8757082</td>
<td style="text-align: right;">1.027697</td>
<td style="text-align: right;">4.231788</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_A_2599</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Ellipsoid</td>
<td style="text-align: right;">0.9021322</td>
<td style="text-align: right;">1.016534</td>
<td style="text-align: right;">4.845816</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_A_2611</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8203610</td>
<td style="text-align: right;">1.040002</td>
<td style="text-align: right;">1.144922</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_B_136</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Ellipsoid</td>
<td style="text-align: right;">0.8791311</td>
<td style="text-align: right;">1.018891</td>
<td style="text-align: right;">1.867975</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_B_140</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8858050</td>
<td style="text-align: right;">1.024280</td>
<td style="text-align: right;">4.030924</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_B_159</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Pyramidal</td>
<td style="text-align: left;">Multifacial</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8631108</td>
<td style="text-align: right;">1.024487</td>
<td style="text-align: right;">4.939933</td>
<td style="text-align: left;">Y</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_B_168</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8992439</td>
<td style="text-align: right;">1.023644</td>
<td style="text-align: right;">3.083931</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_B_186</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Polyhedral</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Box</td>
<td style="text-align: right;">0.8688678</td>
<td style="text-align: right;">1.026525</td>
<td style="text-align: right;">2.674256</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">QSY_B_320</td>
<td style="text-align: left;">Cobble</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Discoid-like</td>
<td style="text-align: right;">0.8589857</td>
<td style="text-align: right;">1.052747</td>
<td style="text-align: right;">1.606183</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QSY_B_435</td>
<td style="text-align: left;">Nodule</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Cubical</td>
<td style="text-align: left;">Polyhedron</td>
<td style="text-align: left;">Ellipsoid</td>
<td style="text-align: right;">0.8578307</td>
<td style="text-align: right;">1.020420</td>
<td style="text-align: right;">2.279425</td>
<td style="text-align: left;">Y</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We applied spherical sphericity index, harmonics analysis, and centroid offset measurements to both the spheroids (n = 13) and all other multifacial and polyhedron cores (n = 29) in the assemblage of QSY. These analyses aim to assess whether spheroids are morphologically distinct from other cores, and whether they exhibit standardized shapes—an essential criterion for evaluating the existence of deliberate shaping strategies and a goal product. In addition, we compare quantitative outcomes with traditional typological classifications to assess their consistency. We present a summary table listing each core’s blank morphology and type, final morphology, and cortex coverage here in <a href="#tbl-cores" class="quarto-xref">Table&nbsp;1</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code for basic morphometry</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mean_sphercity_tbl <span class="ot">&lt;-</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>cores <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grouped_types =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    Typology <span class="sc">==</span> <span class="st">"Polyhedron"</span> <span class="sc">~</span>  <span class="st">"Multifacial"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    Typology <span class="sc">==</span> <span class="st">"Subspheroid"</span> <span class="sc">~</span> <span class="st">"Spheroid"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> Typology</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summary values for Sphericity</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>mean_sphercity_tbl_summary <span class="ot">&lt;-</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  mean_sphercity_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(grouped_types) <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_sphercity =</span> <span class="fu">mean</span>(Sphericity))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>mean_sphercity_tbl_sph <span class="ot">&lt;-</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  mean_sphercity_tbl_summary <span class="sc">%&gt;%</span> </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grouped_types <span class="sc">==</span> <span class="st">"Spheroid"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mean_sphercity) <span class="sc">%&gt;%</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>mean_sphercity_tbl_mult <span class="ot">&lt;-</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  mean_sphercity_tbl_summary <span class="sc">%&gt;%</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grouped_types <span class="sc">==</span> <span class="st">"Multifacial"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mean_sphercity) <span class="sc">%&gt;%</span> </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Mann-Whitney U test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sphericity analysis reveals a clear difference between spheroids and multifacial cores/polyhedra. The mean sphericity of spheroids (0.906) is notably higher than that of multifacial cores and polyhedron (0.861), with a Mann-Whitney U test yielding U = 37.0, p = 3.99 × 10⁻⁵. This result indicates that spheroids possess a more spherical geometry overall, supporting their typological classification.</p>
<p>We conducted shape analysis based on spherical harmonic decomposition, setting the maximum degree to 20 (lmax=20). This choice ensures that sufficient geometric detail is captured while avoiding high-frequency noise and overfitting artifacts such as the Gibbs phenomenon. After normalization, all models have their degree 0 (l=0) coefficient set to 1, allowing for meaningful comparison across different models.</p>
<p>A Variance Analysis was performed on the power of each harmonic degree. The results indicate that l= 2 and l=3 exhibit the highest variance across the sample, suggesting that these low-order terms capture the most significant shape variation. Specifically, l=2 reflects global asymmetries—such as elongation or flattening—while degree 3 is more sensitive to localized features like curvature and edge protrusions.</p>
<p>To visualize the structure of shape variation, we applied UMAP to the normalized power spectrum. The UMAP projection reveals distinct clusters in the first two dimensions of the shape space. These clusters correspond to reference models, sphere, rounded cube, ellipsoid, rounded rectangular prism and disc-shaped core. This demonstrates that these cores occupy distinguishable regions in the harmonic shape space, with proximity to the sphere or elongation/flattening along specific axes emerging as key differentiating features. Most artifacts typologically classified as spheroids or sub-spheroids were grouped into the “rounded cube” and “sphere” clusters, indicating their consistent, near-spherical shapes. However, some Multifacial cores and Polyhedron also appeared in the near-spherical region. This can be attributed to their high cortex coverage or limited flake removals, which likely preserved their originally rounded forms and led to their grouping alongside more intentionally shaped spheroids.</p>
<p>We then tested whether the UMAP-based groupings also correspond to differences in sphericity using a Kruskal–Wallis test, which yielded H = 18.43, p = 3.59 × 10⁻⁴. The result shows statistically significant differences in sphericity among the shape clusters, further supporting the effectiveness of the spherical harmonic approach in capturing meaningful morphological variation.</p>
<p>The spherical harmonic energy (SHE), a novel metric introduced herein, quantifies the geometric approximation of core morphology to an ideal sphere. Normalized SHE approaching unity indicates progressively spherical configurations, while deviations from unity reflect morphological irregularity. Our analysis demonstrates significant negative correlation between SHE and classic sphericity measures (t = -11.012, df = 49, p = 7.443×10⁻¹⁵), validating its efficacy as a proxy of sphericity.</p>
<p>Statistical comparisons reveal distinct SHE distributions between morphological classes: spheroids and sub-spheroids exhibit mean SHE=1.013 (SD ± 0.008), whereas multifacial cores and polyhedron demonstrate significantly higher irregularity (mean SHE=1.032, SD ± 0.014). The Kruskal-Wallis test confirms robust inter-group divergence (H=16.99, p=3.76×10⁻⁵), proving the distinguishability of spheroids in QSY.</p>
<p>The pursuit of a standardized spherical form among spheroids is further supported by our findings. Using the Coefficient of Variation (CV)—defined as the sample standard deviation divided by the sample mean—we assessed the consistency of sphericity within the spheroids. Eerkens (2000) suggested that a CV of under 1.7% (0.017) is a realistic threshold for manually-produced archaeological artifacts. Both sphericity and SHE values yielded low CVs (0.0175 and 0.0068, respectively), indicating that spheroids maintain a highly standardized rounded shape. In contrast, multifacial cores combined with polyhedron has a higher CV of 0.0447 and 0.0191 respectively.</p>
</section>
<section id="results-of-technological-analysis" class="level2">
<h2 class="anchored" data-anchor-id="results-of-technological-analysis">Results of technological analysis</h2>
<p>The diacritical analysis of spheroid surfaces reveals a structured and recurrent reduction sequence comprising the following phases:</p>
<p>Phase 1) unidirectional or bidirectional total exploitation, belonging to one kind of volume exploitation. Large and flat surfaces of the cobble are selected as platforms to striking toward the opposite surface. Knapping proceeds until the peripheral volume is fully exploited, resulting in an approximately cubic form. Phase 2) peripheral centripetal exploitation. In this phase, previous removals in phase 1 serve as platforms for centripetal flaking around the core periphery. This represents a surface exploitation strategy. A notable feature is the angle between the face ventral surface and platform (core edge angle), which often exceeds 90°, forming what the literature refers to as secant plan rather than parallel plans. This approach contributes significantly to the progressive spherical of the shape. Phase 3) small scars on ridges or intersections of previous flake scars, resulting in a rounding and smoother surface, further enhancing sphericality. It is important to note that due to the high degree of reduction intensity observed in most spheroids, phases prior to the initial visible sequence are often obliterated. We hypothesize the existence of a Phase 0, potentially involving roughing-out of the cobble or an earlier cycle of Phases 1–3.</p>
<p>Scar orientation analysis further supports the interpretation of a systematical reduction sequence in the production of QSY spheroids. Shown in the ternary plot, spheroids tend to cluster together, with elongation ratios ranging from 0.403 to 0.637 and isotropy ratios from 0.164 to 0.497. These elongation ratios suggest that the spheroids underwent unidirectional or bidirectional total exploitation, resulting in relatively high elongation values. In addition, the peripheral centripetal exploitation appears to have contributed to a certain degree of isotropy in scar arrangement—higher isotropy ratios are associated with more spherical shapes. Subspheroids exhibit greater variability in both elongation and isotropy ratios, indicating less consistent reduction intensity.</p>
<p>Multifacial cores and polyhedrons display a wide and dispersed distribution in the ternary plot, without forming any distinctive cluster. Their scar patterns show considerable variability in both elongation and isotropy, reinforcing the interpretation that these cores lack removal organization and reflect a SSDA. Multifacial cores typically exploit natural angles with core rotation occurring without a predetermined plan, which belongs to an opportunistic flaking strategy, while polyhedrons—despite showing a higher degree of reduction—follow a similarly unstructured sequence. This distinction highlights the fundamental technological difference between polyhedrons and spheroids at QSY, where they used to be considered as a continuous reduction process: polyhedrons represent exhausted cores, whereas spheroids reflect the presence of a conceptual template and systematic reduction plan.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Scar_count        E1        E2         E3         IS        EL        type
1         18 0.5414393 0.3566594 0.10190130 0.18820450 0.3412752  polyhedron
2          9 0.6088298 0.3425135 0.04865668 0.07991837 0.4374231  polyhedron
3         13 0.6284335 0.2961252 0.07544125 0.12004652 0.5287883  polyhedron
4          8 0.4801475 0.4249347 0.09491774 0.19768454 0.1149913 multifacial
5          7 0.7338336 0.2173081 0.04885832 0.06657957 0.7038728  polyhedron
6         11 0.4834485 0.2958193 0.22073225 0.45657866 0.3881058  polyhedron
        ID
1 QSYA0256
2 QSYA0562
3 QSYA0570
4 QSYA0576
5 QSYA0579
6 QSYA0680</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="paper_files/figure-html/Fig,%20benn_ternary_plot-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>Based on this diacritical analysis and scar orientation analysis, we can summarize the technical strategy employed in the production of faceted spheroids in QSY. This strategy consists of a series of essential and sequential phases: a potential rough-out phase, volume exploitation aimed at forming a cubic shape, surface exploitation to approximate a spheroidal geometry, edge refinement, and potentially the repetition of earlier phases. The existence of a repetitive phase is supported by the observation that while the original cobble blanks in QSY display considerable size variation, the finished spheroids—although some are relatively large—mostly cluster around a diameter of 8–10 cm. This suggests that the production of spheroids may have involved multiple cycles of reduction, and further implies that a diameter of 8–10 cm was considered an optimal or intended size in the knapping process.</p>
</section>
<section id="results-of-technological-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="results-of-technological-analysis-1">Results of technological analysis</h2>
<p>The Spearman correlation analysis shows significant positive correlations among the three variables representing reduction intensity: scar number, removal ratio, and SDI. Among them, scar counts show significant positive correlations with both removal ratio (ρ = 0.74, p = 0.0036) and SDI (ρ = 0.64, p = 0.0187). Removal ratio and SDI exhibit a stronger and highly significant correlation (ρ = 0.89, p &lt; 0.001). These two variables incorporate surface area in their calculation, making them more effective in capturing the density and intensity of reduction, and therefore more reliable indicators of the shaping process in spheroids.</p>
<p>Among the shape descriptors of spheroids, several significant correlations were observed. Mean edge angle was positively correlated with sphericity (ρ = 0.68, p = 0.011) and negatively correlated with SPHARM power (ρ = –0.59, p = 0.035), indicating that greater edge angles are associated with more spherical and regular forms. As noted in previous studies, mean edge angle is a key variable in capturing the morphology of spheroids. This may help explain why spheroids were often interpreted as exhausted cores in earlier research. Indeed, spheroids must be significantly reduced, as achieving a near-perfect spherical shape typically results in increased edge angles, making further flake removal difficult. However, the reverse is not necessarily true—not all exhausted cores evolve into spheroids.</p>
<p>Curvature was only significantly correlated with sphericity (ρ = –0.57, p = 0.041), suggesting that smoother surfaces tend to approximate spheres more closely. Its lack of correlation with other variables may reflect its focus on local surface texture, while edge angle and SPHARM power capture broader aspects of shape regularity and symmetry.</p>
<p>The weak correlation between sphericity and SPHARM power may result from the small sample size or their different sensitivities: sphericity, based on area and volume, tolerates surface variation, while SPHARM power responds more to asymmetry and irregularity. Thus, even in similarly spherical specimens, surface differences can produce substantial variation in SPHARM power.</p>
<p>The analysis of spheroid shape variables indicates that mean edge angle, curvature, sphericity, and SPHARM power each capture distinct aspects of spheroid morphology, which explains the varying strengths of correlation observed among them.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14  7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Scar.number"     "Removal.ratio"   "SDI"             "Edge.angle.mean"
[5] "Curvature"       "Sphericity"      "SPHARM.power"   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Spearman correlation matrix:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Scar.number Removal.ratio     SDI Edge.angle.mean Curvature
Scar.number          1.0000        0.7438  0.6391          0.6832   -0.0028
Removal.ratio        0.7438        1.0000  0.8901          0.6099   -0.0055
SDI                  0.6391        0.8901  1.0000          0.4890   -0.0714
Edge.angle.mean      0.6832        0.6099  0.4890          1.0000   -0.3626
Curvature           -0.0028       -0.0055 -0.0714         -0.3626    1.0000
Sphericity           0.1598        0.1209 -0.0220          0.6758   -0.5714
SPHARM.power        -0.5289       -0.5989 -0.5769         -0.5879    0.0165
                Sphericity SPHARM.power
Scar.number         0.1598      -0.5289
Removal.ratio       0.1209      -0.5989
SDI                -0.0220      -0.5769
Edge.angle.mean     0.6758      -0.5879
Curvature          -0.5714       0.0165
Sphericity          1.0000      -0.3132
SPHARM.power       -0.3132       1.0000</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P-value matrix:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Scar.number Removal.ratio    SDI Edge.angle.mean Curvature
Scar.number              NA        0.0036 0.0187          0.0101    0.9929
Removal.ratio        0.0036            NA 0.0000          0.0269    0.9858
SDI                  0.0187        0.0000     NA          0.0899    0.8166
Edge.angle.mean      0.0101        0.0269 0.0899              NA    0.2233
Curvature            0.9929        0.9858 0.8166          0.2233        NA
Sphericity           0.6021        0.6940 0.9432          0.0112    0.0413
SPHARM.power         0.0631        0.0306 0.0390          0.0346    0.9574
                Sphericity SPHARM.power
Scar.number         0.6021       0.0631
Removal.ratio       0.6940       0.0306
SDI                 0.9432       0.0390
Edge.angle.mean     0.0112       0.0346
Curvature           0.0413       0.9574
Sphericity              NA       0.2974
SPHARM.power        0.2974           NA</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="paper_files/figure-html/Fig%20spearman%20correlation%20matrix-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<!-- Here's some example analysis code: -->
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">here</span>(<span class="st">"analysis/paper/figures/1.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-m" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: the
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-m" class="quarto-xref">Figure&nbsp;1</a> shows…</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
</section>
<section id="acknowledgements" class="level1">
<h1>Acknowledgements</h1>
<!-- The following line inserts a page break  -->
<div style="page-break-after: always;"></div>
</section>
<section id="references" class="level1">
<h1>References</h1>
<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Van2023" class="csl-entry" role="listitem">
Bavel, Casper van, Wim Thiels, and Rob Jelier. 2023. <span>“Cell Shape Characterization, Alignment, and Comparison Using FlowShape.”</span> <em>Bioinformatics</em> 39 (6): btad383.
</div>
<div id="ref-Cabanes2024" class="csl-entry" role="listitem">
Cabanès, Julia, Antony Borel, Javier Baena Preysler, Antoine Lourdeau, Dominique Cliquet, David Colonge, and Marie-Hélène Moncel. 2024. <span>“Exploring the Technological and Functional Diversity of Polyhedrons, Spheroids and Bolas: An Integrated and Comparative Analysis of Cases from France and North Africa.”</span> <em>Journal of Paleolithic Archaeology</em> 7 (1): 30. <a href="https://doi.org/10.1007/s41982-024-00195-x">https://doi.org/10.1007/s41982-024-00195-x</a>.
</div>
<div id="ref-clarksonMeasuringCoreReduction2013" class="csl-entry" role="listitem">
Clarkson, Chris. 2013. <span>“Measuring Core Reduction Using 3D Flake Scar Density: A Test Case of Changing Core Reduction at Klasies River Mouth, South Africa.”</span> <em>Journal Of Archaeological Science</em> 40 (12): 4348–57.
</div>
<div id="ref-Harper2022" class="csl-entry" role="listitem">
Harper, Christine M, Deanna M Goldstein, and Adam D Sylvester. 2022. <span>“Comparing and Combining Sliding Semilandmarks and Weighted Spherical Harmonics for Shape Analysis.”</span> <em>Journal of Anatomy</em> 240 (4): 678–87.
</div>
<div id="ref-Lin2024" class="csl-entry" role="listitem">
Lin, Sam C. 2024. <span>“A New Method for Quantifying Flake Scar Organisation on Cores Using Orientation Statistics.”</span> <em>Journal of Archaeological Science</em>.
</div>
<div id="ref-Link2024" class="csl-entry" role="listitem">
Link, Rabea, Mona Jaggy, Martin Bastmeyer, and Ulrich S Schwarz. 2024. <span>“Modelling Cell Shape in 3D Structured Environments: A Quantitative Comparison with Experiments.”</span> <em>PLOS Computational Biology</em> 20 (4): e1011412.
</div>
<div id="ref-Marwick2017" class="csl-entry" role="listitem">
Marwick, Ben. 2017. <span>“Computational Reproducibility in Archaeological Research: Basic Principles and a Case Study of Their Implementation.”</span> <em>Journal of Archaeological Method and Theory</em> 24 (2): 424–50. <a href="https://doi.org/10.1007/s10816-015-9272-9">https://doi.org/10.1007/s10816-015-9272-9</a>.
</div>
<div id="ref-Medyukhina2020" class="csl-entry" role="listitem">
Medyukhina, Anna, Marco Blickensdorf, Zoltán Cseresnyés, Nora Ruef, Jens V Stein, and Marc Thilo Figge. 2020. <span>“Dynamic Spherical Harmonics Approach for Shape Classification of Migrating Cells.”</span> <em>Scientific Reports</em> 10 (1): 6072.
</div>
<div id="ref-Muller2023" class="csl-entry" role="listitem">
Muller, Antoine, Deborah Barsky, Robert Sala-Ramos, Gonen Sharon, Stefania Titton, Josep-Maria Vergès, and Leore Grosman. 2023. <span>“The Limestone Spheroids of ‘Ubeidiya: Intentional Imposition of Symmetric Geometry by Early Hominins?”</span> <em>Royal Society Open Science</em> 10 (9): 230671.
</div>
<div id="ref-Noshita2025" class="csl-entry" role="listitem">
Noshita, Koji, Tomomi Nakagawa, Akihiro Kaneda, Kohei Tamura, and Hisashi Nakao. 2025. <span>“The Cultural Transmission of Ongagawa Style Pottery in the Prehistoric Japan: Quantitative Analysis on Three-Dimensional Data of Archaeological Pottery in the Early Yayoi Period.”</span> <em>Journal of the Royal Society Interface</em> 22 (223): 20240889.
</div>
<div id="ref-tittonSubspheroidsLithicAssemblage2020" class="csl-entry" role="listitem">
Titton, Stefania, Deborah Barsky, Amèlia Bargalló, Alexia Serrano-Ramos, Josep Maria Vergès, Isidro Toro-Moyano, Robert Sala-Ramos, José García Solano, and Juan Manuel Jimenez Arenas. 2020. <span>“Subspheroids in the Lithic Assemblage of Barranco León (Spain): Recognizing the Late Oldowan in Europe.”</span> <em>PLOS ONE</em> 15 (1): e0228290. <a href="https://doi.org/10.1371/journal.pone.0228290">https://doi.org/10.1371/journal.pone.0228290</a>.
</div>
<div id="ref-Wadell1935" class="csl-entry" role="listitem">
Wadell, Hakon. 1935. <span>“Volume, <span>Shape</span>, and <span>Roundness</span> of <span>Quartz</span> <span>Particles</span>.”</span> <em>The Journal of Geology</em> 43 (3): 250–80. <a href="https://doi.org/10.1086/624298">https://doi.org/10.1086/624298</a>.
</div>
</div>
<div style="page-break-after: always;"></div>
<section id="colophon" class="level3">
<h3 class="anchored" data-anchor-id="colophon">Colophon</h3>
<p>This report was generated on 2025-06-03 12:06:30.361269 using the following computational environment and dependencies:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which R packages and versions?</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"devtools"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) devtools<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.5.0 (2025-04-11)
 os       macOS Ventura 13.3.1
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Los_Angeles
 date     2025-06-03
 pandoc   3.4 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)
 quarto   1.4.549 @ /usr/local/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version  date (UTC) lib source
 abind          1.4-8    2024-09-12 [1] CRAN (R 4.5.0)
 ash            1.0-15   2015-09-01 [1] CRAN (R 4.5.0)
 backports      1.5.0    2024-05-23 [1] CRAN (R 4.5.0)
 base64enc      0.1-3    2015-07-28 [1] CRAN (R 4.5.0)
 bayesm         3.1-6    2023-09-23 [1] CRAN (R 4.5.0)
 boot           1.3-31   2024-08-28 [1] CRAN (R 4.5.0)
 broom          1.0.8    2025-03-28 [1] CRAN (R 4.5.0)
 cachem         1.1.0    2024-05-16 [1] CRAN (R 4.5.0)
 car            3.1-3    2024-09-27 [1] CRAN (R 4.5.0)
 carData        3.0-5    2022-01-06 [1] CRAN (R 4.5.0)
 cellranger     1.1.0    2016-07-27 [1] CRAN (R 4.5.0)
 checkmate      2.3.2    2024-07-29 [1] CRAN (R 4.5.0)
 circular     * 0.5-1    2024-08-29 [1] CRAN (R 4.5.0)
 cli            3.6.5    2025-04-23 [1] CRAN (R 4.5.0)
 cluster        2.1.8.1  2025-03-12 [1] CRAN (R 4.5.0)
 colorspace     2.1-1    2024-07-26 [1] CRAN (R 4.5.0)
 compositions   2.0-8    2024-01-31 [1] CRAN (R 4.5.0)
 data.table   * 1.17.0   2025-02-22 [1] CRAN (R 4.5.0)
 DEoptimR       1.1-3-1  2024-11-23 [1] CRAN (R 4.5.0)
 devtools       2.4.5    2022-10-11 [1] CRAN (R 4.5.0)
 digest         0.6.37   2024-08-19 [1] CRAN (R 4.5.0)
 dplyr        * 1.1.4    2023-11-17 [1] CRAN (R 4.5.0)
 ellipsis       0.3.2    2021-04-29 [1] CRAN (R 4.5.0)
 evaluate       1.0.3    2025-01-10 [1] CRAN (R 4.5.0)
 extrafont      0.19     2023-01-18 [1] CRAN (R 4.5.0)
 extrafontdb    1.0      2012-06-11 [1] CRAN (R 4.5.0)
 farver         2.1.2    2024-05-13 [1] CRAN (R 4.5.0)
 fastmap        1.2.0    2024-05-15 [1] CRAN (R 4.5.0)
 forcats      * 1.0.0    2023-01-29 [1] CRAN (R 4.5.0)
 foreign        0.8-90   2025-03-31 [1] CRAN (R 4.5.0)
 Formula        1.2-5    2023-02-24 [1] CRAN (R 4.5.0)
 fs             1.6.6    2025-04-12 [1] CRAN (R 4.5.0)
 generics       0.1.3    2022-07-05 [1] CRAN (R 4.5.0)
 ggalt        * 0.4.0    2017-02-15 [1] CRAN (R 4.5.0)
 ggcorrplot   * 0.1.4.1  2023-09-05 [1] CRAN (R 4.5.0)
 ggplot2      * 3.5.2    2025-04-09 [1] CRAN (R 4.5.0)
 ggpubr       * 0.6.0    2023-02-10 [1] CRAN (R 4.5.0)
 ggsignif       0.6.4    2022-10-13 [1] CRAN (R 4.5.0)
 ggtern       * 3.5.0    2024-03-24 [1] CRAN (R 4.5.0)
 glue           1.8.0    2024-09-30 [1] CRAN (R 4.5.0)
 gridExtra      2.3      2017-09-09 [1] CRAN (R 4.5.0)
 gtable         0.3.6    2024-10-25 [1] CRAN (R 4.5.0)
 here         * 1.0.1    2020-12-13 [1] CRAN (R 4.5.0)
 hexbin         1.28.5   2024-11-13 [1] CRAN (R 4.5.0)
 Hmisc        * 5.2-3    2025-03-16 [1] CRAN (R 4.5.0)
 hms            1.1.3    2023-03-21 [1] CRAN (R 4.5.0)
 htmlTable      2.4.3    2024-07-21 [1] CRAN (R 4.5.0)
 htmltools      0.5.8.1  2024-04-04 [1] CRAN (R 4.5.0)
 htmlwidgets    1.6.4    2023-12-06 [1] CRAN (R 4.5.0)
 httpuv         1.6.16   2025-04-16 [1] CRAN (R 4.5.0)
 jsonlite       2.0.0    2025-03-27 [1] CRAN (R 4.5.0)
 KernSmooth     2.23-26  2025-01-01 [1] CRAN (R 4.5.0)
 knitr          1.50     2025-03-16 [1] CRAN (R 4.5.0)
 labeling       0.4.3    2023-08-29 [1] CRAN (R 4.5.0)
 later          1.4.2    2025-04-08 [1] CRAN (R 4.5.0)
 latex2exp      0.9.6    2022-11-28 [1] CRAN (R 4.5.0)
 lattice        0.22-6   2024-03-20 [1] CRAN (R 4.5.0)
 lifecycle      1.0.4    2023-11-07 [1] CRAN (R 4.5.0)
 lubridate    * 1.9.4    2024-12-08 [1] CRAN (R 4.5.0)
 magrittr       2.0.3    2022-03-30 [1] CRAN (R 4.5.0)
 maps           3.4.2.1  2024-11-10 [1] CRAN (R 4.5.0)
 MASS           7.3-65   2025-02-28 [1] CRAN (R 4.5.0)
 memoise        2.0.1    2021-11-26 [1] CRAN (R 4.5.0)
 mime           0.13     2025-03-17 [1] CRAN (R 4.5.0)
 miniUI         0.1.2    2025-04-17 [1] CRAN (R 4.5.0)
 mvtnorm        1.3-3    2025-01-10 [1] CRAN (R 4.5.0)
 NISTunits    * 1.0.1    2016-08-11 [1] CRAN (R 4.5.0)
 nnet           7.3-20   2025-01-01 [1] CRAN (R 4.5.0)
 pillar         1.10.2   2025-04-05 [1] CRAN (R 4.5.0)
 pkgbuild       1.4.7    2025-03-24 [1] CRAN (R 4.5.0)
 pkgconfig      2.0.3    2019-09-22 [1] CRAN (R 4.5.0)
 pkgload        1.4.0    2024-06-28 [1] CRAN (R 4.5.0)
 plyr           1.8.9    2023-10-02 [1] CRAN (R 4.5.0)
 profvis        0.4.0    2024-09-20 [1] CRAN (R 4.5.0)
 proj4          1.0-15   2025-03-21 [1] CRAN (R 4.5.0)
 promises       1.3.2    2024-11-28 [1] CRAN (R 4.5.0)
 proto          1.0.0    2016-10-29 [1] CRAN (R 4.5.0)
 purrr        * 1.0.4    2025-02-05 [1] CRAN (R 4.5.0)
 R6             2.6.1    2025-02-15 [1] CRAN (R 4.5.0)
 RColorBrewer   1.1-3    2022-04-03 [1] CRAN (R 4.5.0)
 Rcpp           1.0.14   2025-01-12 [1] CRAN (R 4.5.0)
 readr        * 2.1.5    2024-01-10 [1] CRAN (R 4.5.0)
 readxl       * 1.4.5    2025-03-07 [1] CRAN (R 4.5.0)
 remotes        2.5.0    2024-03-17 [1] CRAN (R 4.5.0)
 reshape2     * 1.4.4    2020-04-09 [1] CRAN (R 4.5.0)
 rlang          1.1.6    2025-04-11 [1] CRAN (R 4.5.0)
 rmarkdown      2.29     2024-11-04 [1] CRAN (R 4.5.0)
 robustbase     0.99-4-1 2024-09-27 [1] CRAN (R 4.5.0)
 rpart          4.1.24   2025-01-07 [1] CRAN (R 4.5.0)
 rprojroot      2.0.4    2023-11-05 [1] CRAN (R 4.5.0)
 rstatix        0.7.2    2023-02-01 [1] CRAN (R 4.5.0)
 rstudioapi     0.17.1   2024-10-22 [1] CRAN (R 4.5.0)
 Rttf2pt1       1.3.12   2023-01-22 [1] CRAN (R 4.5.0)
 scales         1.4.0    2025-04-24 [1] CRAN (R 4.5.0)
 sessioninfo    1.2.3    2025-02-05 [1] CRAN (R 4.5.0)
 shiny          1.10.0   2024-12-14 [1] CRAN (R 4.5.0)
 stringi        1.8.7    2025-03-27 [1] CRAN (R 4.5.0)
 stringr      * 1.5.1    2023-11-14 [1] CRAN (R 4.5.0)
 tensorA        0.36.2.1 2023-12-13 [1] CRAN (R 4.5.0)
 tibble       * 3.2.1    2023-03-20 [1] CRAN (R 4.5.0)
 tidyr        * 1.3.1    2024-01-24 [1] CRAN (R 4.5.0)
 tidyselect     1.2.1    2024-03-11 [1] CRAN (R 4.5.0)
 tidyverse    * 2.0.0    2023-02-22 [1] CRAN (R 4.5.0)
 timechange     0.3.0    2024-01-18 [1] CRAN (R 4.5.0)
 tzdb           0.5.0    2025-03-15 [1] CRAN (R 4.5.0)
 urlchecker     1.0.1    2021-11-30 [1] CRAN (R 4.5.0)
 usethis        3.1.0    2024-11-26 [1] CRAN (R 4.5.0)
 vctrs          0.6.5    2023-12-01 [1] CRAN (R 4.5.0)
 withr          3.0.2    2024-10-28 [1] CRAN (R 4.5.0)
 xfun           0.52     2025-04-02 [1] CRAN (R 4.5.0)
 xtable         1.8-4    2019-04-21 [1] CRAN (R 4.5.0)
 yaml           2.3.10   2024-07-26 [1] CRAN (R 4.5.0)

 [1] /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library
 * ── Packages attached to the search path.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
<p>The current Git commit details are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what commit is this file at? </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"git2r"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>() <span class="sc">&amp;</span> git2r<span class="sc">::</span><span class="fu">in_repository</span>(<span class="at">path =</span> <span class="st">"."</span>)) git2r<span class="sc">::</span><span class="fu">repository</span>(here<span class="sc">::</span><span class="fu">here</span>())  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Local:    main /Users/bmarwick/Downloads/QSY-Spheroids-Study
Remote:   main @ origin (https://github.com/zhiye0927/QSY-Spheroids-Study)
Head:     [45f0c35] 2025-06-03: conflicts</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>